---
import { SITE, LINKS } from "@consts"
import { cn } from "@lib/utils"
const { pathname } = Astro.url
const subpath = pathname.match(/[^/]+/g)
---

<div id="drawer" class="fixed inset-0 h-0 z-40 overflow-hidden flex flex-col items-center justify-center md:hidden bg-neutral-100 dark:bg-neutral-900 transition-[height] duration-300 ease-in-out">
  <nav class="flex flex-col items-center space-y-2">
    {
      LINKS.map((LINK) => (
        <div class="relative group">
          <a href={LINK.HREF} class={cn("h-8 rounded-full px-3 text-current", "flex items-center justify-center", "transition-colors duration-300 ease-in-out", pathname === LINK.HREF || "/" + subpath?.[0] === LINK.HREF ? "bg-black dark:bg-white text-white dark:text-black" : "hover:bg-black/5 dark:hover:bg-white/20 hover:text-black dark:hover:text-white")}>
            {LINK.TEXT}
          </a>
          {LINK.SUBLINKS && (
            <div class="absolute left-0 top-full mt-1 hidden group-hover:block bg-white dark:bg-gray-800 rounded shadow-lg">
              {
                LINK.SUBLINKS.map((SUBLINK) => (
                  <a href={SUBLINK.HREF} class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                    {SUBLINK.TEXT}
                  </a>
                ))
              }
            </div>
          )}
            </div>
          ))
        }
  </nav>

  <div class="flex gap-1 mt-5">
    <a href="/search" aria-label={`Busca publicaciones, wikis y projectos de ${SITE.TITLE}`} class={cn("size-9 rounded-full p-2 items-center justify-center bg-transparent hover:bg-black/5 dark:hover:bg-white/20 stroke-current hover:stroke-black hover:dark:stroke-white border border-black/10 dark:border-white/25 transition-colors duration-300 ease-in-out", pathname === "/search" || "/" + subpath?.[0] === "search" ? "pointer-events-none bg-black dark:bg-white text-white dark:text-black" : "")}>
      <svg class="size-full">
        <use href="/assets/svg/ui.svg#search"></use>
      </svg>
    </a>

    <button id="drawer-theme-button" aria-label={`Toggle light and dark theme`} class="size-9 rounded-full p-2 items-center justify-center bg-transparent hover:bg-black/5 dark:hover:bg-white/20 stroke-current hover:stroke-black hover:dark:stroke-white border border-black/10 dark:border-white/25 transition-colors duration-300 ease-in-out">
      <svg class="block dark:hidden size-full">
        <use href="/assets/svg/ui.svg#sun"></use>
      </svg>
      <svg class="hidden dark:block size-full">
        <use href="/assets/svg/ui.svg#moon"></use>
      </svg>
    </button>

    <a href="https://github.com/BrosLunas/broslunas-astro" aria-label={`Busca publicaciones y projectos de ${SITE.TITLE}`} class={cn("size-9 rounded-full p-2 items-center justify-center bg-transparent hover:bg-black/5 dark:hover:bg-white/20 stroke-current hover:stroke-black hover:dark:stroke-white border border-black/10 dark:border-white/25 transition-colors duration-300 ease-in-out", pathname === "https://github.com/BrosLunas/broslunas-astro" || "/" + subpath?.[0] === "search" ? "pointer-events-none bg-black dark:bg-white text-white dark:text-black" : "")}>
    <img src="/assets/svg/github-white.svg" class="size-full">
    </a>
  </div>
</div>

<style>
  #drawer.open {
    @apply h-full;
  }
</style>